# Настройка соответствий платежей

## Разделы документации

* [Работа с расширением](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/how-to-work)
* [Настройки соответствия платежей](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings)
* [Настройки КФО](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/settings-kfo)
* [Часто задаваемые вопросы](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/faq)

## Назначение

Настройки предназначены для устранения ошибок при загрузке данных из файлов с помощью указания ключевых слов из назначений платежей.

## Как найти настройки

На форме обработки открыть вкладку ``Настройки -> Сооответствия платежей``.

## Пример настройки

Выберем файл, который нужно импортировать. Никаких настроек делать не будем, нажмем на команду ``Предварительный просмотр``. 

Посмотрим, что сформировалось:

![Пример неправильного результата](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-uncorrected.png)

Обратим внимание на назначение платежа:

![Пример неправильного результата](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-uncorrected-comment.png)

В строках 10-11 СубкнотоДт1 сформировался неправильно. Видим, что в назначении платежа указано ключевое слово ``з/плата``, с помощью которого мы сможем решить нашу проблему.

* Откроем настройки.
* Создадим нужную настройку.

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-settings.png)

Здесь мы написали, что, если в назначении платежа встречается слово «з/плата», тогда Счет Дт поменять на 302.11, а субконтоДт (контрагент) этого счета сделать равным «по всем сотрудникам». Также указана соответствующая типовая операция для таких строк.

Посмотрим на результат настройки, нажав на кнопку ``Предварительный просмотр``.

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-corrected.png)

Обратите внимание, что в условии можно указывать несколько ключевых слов через символ «;». Это полезно для ситуаций, когда в строки, где содержится, например, ключевое слово «отпуск», нужно тоже подставлять счет 302.11, и субконто контрагенты «по всем сотрудникам». Для этого в настройках нужно указать такое выражение: ``з/плата;отпуск``. И таким образом, для всех строк, где содержатся ключевые слова ``з/плата`` или ``отпуск`` будут подставлены указанный в настройках счет и субконто.

## Пример настройки табельных номеров

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-uncorrected-tn.png)

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-uncorrected-tn-comment.png)

Видим, что в назначении платежа указан сотрудник, которому была начислена зарплата, а в СубконтоДт подставилось наше условие «все сотрудники», и это неправильно.

Решим эту проблему. Для этого снова воспользуемся содержанием назначения платежа: оно содержит табельный номер сотрудника. В свою очередь, обработка содержит механизм, предусматривающий наличие табельных номеров в назначениях платежей, если пользователь сам укажет это. Для этого в настройках укажем еще одно условие:

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-settings-tn.png)

В назначении платежа указано ключевое слово «тн». Это означает, что для каждой строки, где содержится слово «тн», «таб.ном» или «таб.номер» будем произведен поиск сотрудника по табельному номеру, указанному в назначении платежа (в данном случае, это 252) — это будет СубконтоДт, а Счет Дт будет заменен на счет группы 208, в зависимости от того, какой КЭК Кт был указан в файле. А при импорте  после создания документа «Кассовое выбытие» будет создан документ «Авансовый отчет».
Посмотрим на результат:

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/example-corrected-tn.png)

Важно: в предыдущем примере строка настроек для табельных номеров была перемещена на первую позицию. Это связано с приоритетом, т.к. в одном назначении может содержаться и «з/плата» и, например, «тн». И для того, чтобы понять, какую настройку использовать, используется наиболее высшая.

## Настройка типовых операций

Настройки типовых операций можно указать в той же таблице в самом низу, то есть они будут применяться в самую последнюю очередь, если никакие настройки, стоящие выше, не применились. 

![Пример настройки](https://sorokinltd.github.io/import-from-treasury-systems-doc.github.io/docs/payment-match-settings/settings-to.png)

Таким образом, для всех строк, относящихся к группе счетов «302.00» (кроме тех строк, у которых есть в назначении «з/плата»), установится такая типовая операция.